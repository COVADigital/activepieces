---
title: 'Create Action'
icon: 'circle-4'
description: ''
---

Now that the authentication for the `ClickUp` piece has been established, let's proceed to create the first action. This action will involve creating a new task tag for a specific space in ClickUp.

### Action Defination

To create action run the following command,

```bash
npm run cli actions create
```

You will be asked three questions to define your new piece:

1. `Piece Folder Name`: This is the name associated with the folder where the action resides. It helps organize and categorize actions within the piece.
2. `Action Display Name`: Referring to the name displayed in the user interface (UI), the Action Display Name is what users will see when interacting with the specific action. It should be clear and indicative of the action's purpose.
3. `Action Description`: The Action Description is a concise yet informative text that appears in the UI, providing users with details about the functionality and purpose of the action. It serves as a helpful guide for users navigating through the available actions within the piece.

**Example:**

```bash
npm run cli actions create

? Enter the piece folder name : clickup
? Enter the action display name : create task tag
? Enter the action description : creates a new tasks tag for a space.
```

This will create new typescript file at `packages/pieces/community/clickup/src/lib/actions`,the `create-task-tag.ts` file should contain following code.

```typescript
import { createAction, Property } from '@activepieces/pieces-framework';

export const createTaskTag = createAction({
  // auth: check https://www.activepieces.com/docs/developers/piece-reference/authentication,
  name: 'createTaskTag',
  displayName: 'create task tag',
  description: 'creates a new tasks tag for a space',
  props: {},
  async run() {
    // Action logic here
  },
});
```

The `createAction` function takes an object with several properties, including the `name`, `displayName`,`auth`, `description`, `props`, and `run` function of the action.
Here's a breakdown of the key components:

- `name`: This property serves as a unique identifier for the action within the piece.
- `displayName`:The human-readable name displayed in the user interface (UI) for this action. In this case, it's set as 'create task tag'.
- `description`:A brief description providing information about the purpose of the action. In this instance, it describes the action as creating a new task tag for a space.
- `auth`: The auth property can be utilized to specify authentication requirements for the piece. Authentication is crucial for secure interactions with external services, as detailed in the [authentication documentation](https://www.activepieces.com/docs/developers/piece-reference/authentication).
- `props` - This property defines the set of properties required for the action. Currently set as an empty object, it can be populated with specific properties as needed for the task as detailed in the [props documentation](https://www.activepieces.com/docs/developers/piece-reference/properties).
- `run` function: The logic for the action is implemented within the run function. This function is called when the action is executed. It takes a single argument, context, which contains the values of the actionâ€™s properties.

### Action Authentication

By linking the action to the established piece-level authentication, the `createTaskTag` action aligns seamlessly with the overall security and authentication strategy defined for the ClickUp piece. This promotes consistency and simplifies the management of authentication across multiple actions within the same piece.

```typescript
import { createAction, Property } from '@activepieces/pieces-framework';
import { clickupAuth } from '../../..';

export const createTaskTag = createAction({
  auth: clickupAuth,
  name: 'createTaskTag',
  displayName: 'create task tag',
  description: 'creates a new tasks tag for a space',
  props: {},
  async run() {
    // Action logic here
  },
});
```

### Action Props

To define the required properties for the `createTaskTag` action, we can consult the ClickUp API documentation, specifically focusing on the [endpoint](https://clickup.com/api/clickupreference/operation/CreateSpaceTag/) responsible for creating a task tag.

As per the documentation, the endpoint for creating a task tag in ClickUp requires two mandatory properties:

1. `space_id`: This property identifies the space where the task tag will be created. It specifies the context or location within ClickUp.

2. `tag object`: The tag object contains details about the task tag to be created. This could include properties such as the tag's `name`, `tag_fg` and `tag_bg` attributes.

To specify the required prop types for the `createTaskTag` action, we will employ the [Number](https://www.activepieces.com/docs/developers/piece-reference/properties#number) type for the `space_id` property. This numeric field identifies the space where the task tag will be created.

For the `tag` object, we will utilize the [ShortText](https://www.activepieces.com/docs/developers/piece-reference/properties#short-text) type. This text field accommodates the necessary details for creating a task tag, including attributes such as name, tag_fg, and tag_bg.

```typescript
//...

export const createTasktag = createAction({
  //..
  props: {
    space_id: Property.Number({
      displayName: 'Space ID',
      required: true,
    }),
    tag_name: Property.ShortText({
      displayName: 'Tag Name',
      required: true,
    }),
    tag_fg: Property.ShortText({
      displayName: 'Tag Forground Color',
      required: true,
    }),
    tag_bg: Property.ShortText({
      displayName: 'Tag Backgorund Color',
      required: true,
    }),
  },
});
```

### Run Function

Following the definition of props, the next step involves creating a run function responsible for initiating the API request to execute the `createTaskTag` action.

The `run` function will encompass the necessary logic to construct the API request, incorporating the provided props such as space_id and tag object. It will then dispatch the request to the ClickUp API, triggering the creation of the specified task tag.

Let's construct request for Clickup API.

```typescript
//..
import {
  HttpClient,
  HttpRequest,
  HttpMethod,
} from '@activepieces/pieces-common';

export const createTaskTag = createAction({
  //..
  async run(context) {
    const { space_id, tag_name, tag_fg, tag_bg } = context.propsvalue;
    const request: HttpRequest = {
      method: HttpMethod.POST,
      url: `https://api.clickup.com/api/v2/space/${space_id}/tag`,
      headers: {
        Authorization: context.auth as string,
      },
      body: {
        tag: {
          name: tag_name,
          tag_fg: tag_fg,
          tag_bg: tag_bg,
        },
      },
    };

    const res = await httpClient.sendRequest(request);

    // This data, obtained from the API response, will be displayed in the UI upon successful execution of the action.
    return res.body;
  },
});
```

`run` function utilizes the provided `context` object, extracting necessary properties like `space_id`, `tag_name`, `tag_fg`, and `tag_bg` from `context.propsValue` and personal token from `context.auth`.

### Expose The Definition

To make the action readable by Activepieces, add it to the array of actions in the piece definition.

Let's add `createTaskTag` action by modifing `src/index.ts` file

```typescript
import { createPiece, PieceAuth } from '@activepieces/pieces-framework';
// Don't forget to add the following import.
import { createTaskTag } from './lib/actions/create-task-tag.ts';

export const clickup = createPiece({
  displayName: 'Clickup',
  auth: clickupAuth,
  minimumSupportedRelease: '0.9.0',
  logoUrl: 'https://cdn.activepieces.com/pieces/clickup.png',
  authors: [],
  // Add the action here.
  actions: [createTaskTag], // <--------
  triggers: [],
});
```

### Testing

Before proceeding with testing our first action, ensure to include 'clickup' in the AP_DEV_PIECES variable inside the /packages/backend/.env file. Update the line as follows:

```bash
AP_DEV_PIECES="google-sheets,store,clickup" // <--- add here
```

Now, let's run npm start to initiate ActivePieces, and navigate to **localhost:4200**. If you are launching the server for the first time, it may prompt you to sign in. In such cases, use the following credentials:

Email : `dev@ap.com` Password: `12345678`
